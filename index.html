<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Old Man Edits</title>
  <style>
  @font-face {
  font-family: 'Roboto Mono';
  src: url('/fonts/roboto-mono/RobotoMono-Regular.woff2') format('woff2'),
       url('/fonts/roboto-mono/RobotoMono-Regular.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Roboto Mono';
  src: url('/fonts/roboto-mono/RobotoMono-Bold.woff2') format('woff2'),
       url('/fonts/roboto-mono/RobotoMono-Bold.woff') format('woff');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

body {
  font-family: 'Roboto Mono', monospace;
}


:root{
  --bg-color:#181820;
  --text-color:#fff;
  --accent:#39d353;
  --subtle:#b0b0b0;
  --card-bg: rgba(8,8,10,0.55);
  --card-border: rgba(57,211,83,0.18);
  --glass-blur: 6px;
  --card-radius:18px;
}

/* Reset + base */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:'Roboto Mono', monospace;
  color:var(--text-color);
  background: linear-gradient(to bottom, #000000, var(--bg-color));
  overflow-x:hidden;
  line-height:1.5;
  position:relative;
}

/* Header + hero (kept mostly from original) */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:20px 50px; z-index:3; position:relative;
}
header h1{font-weight:700;font-size:1.4rem;letter-spacing:1px}
nav a{color:var(--text-color);text-decoration:none;margin-left:22px;font-weight:500;transition:color .2s}
nav a:hover{color:var(--accent)}

/* Hero */
.hero{
  text-align:center;padding:28px 20px 16px;z-index:2;position:relative;
}
.hero h2{font-size:1.6rem;font-weight:700;margin-bottom:6px}
.hero h2 .accent{color:var(--accent)}
.hero p{color:var(--subtle);font-size:1.05rem;margin-bottom:8px}
.hero button{
  background:transparent;border:2px solid var(--accent);color:var(--accent);
  padding:8px 16px;font-weight:700;border-radius:6px;cursor:pointer;transition:all .2s
}
.hero button:hover{background:var(--accent);color:var(--bg-color)}

/* Canvas sits behind everything */
#bg-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none}

/* Page layout */
.page-wrap{max-width:1400px;margin:18px auto;padding:12px 18px;position:relative;z-index:2}
.content-area{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}

/* Left panel: search + grid */
.tools{display:flex;gap:12px;align-items:center;margin-bottom:14px}
.back-btn{display:inline-flex;align-items:center;justify-content:center;width:52px;height:44px;border-radius:10px;border:1.6px solid var(--card-border);background:var(--card-bg);cursor:pointer}
.search{flex:1}
.search input{width:100%;padding:12px 14px;border-radius:8px;border:1.5px solid var(--card-border);background:transparent;color:var(--text-color);font-size:1rem}

.gallery-wrap{background:transparent;padding:6px}
.gallery-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px;align-items:start}
.folder-card{
  height:200px;background:var(--card-bg);border-radius:12px;border:1.6px solid var(--card-border);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;position:relative;overflow:hidden;padding:12px;
}
.folder-card img{max-width:100%;max-height:100%;object-fit:cover;border-radius:8px;opacity:0.98}
.folder-card .label{position:absolute;left:18px;bottom:16px;font-size:1.1rem;font-weight:700;color:var(--text-color);text-shadow:0 2px 8px rgba(0,0,0,0.6)}

/* Footer note about scroll */
.gallery-wrap .note{color:var(--subtle);font-size:.95rem;text-align:center;margin-top:8px}

/* ---------- PROFILE CARD (right side) ---------- */
.profile-card{
  position: sticky;
  top: 33px;
  width: 510px;
  max-width: 54vw;
  background: var(--card-bg);
  border-radius: var(--card-radius);
  border: 1.5px solid var(--card-border);
  padding: 18px;
  z-index: 3;
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
  backdrop-filter: blur(var(--glass-blur));
  color:var(--text-color);
}

/* Rounded top highlight (like your image) */
.profile-avatar{
  width: 220px;
  height: 220px;
  border-radius: 1998px;
  margin: 0 auto 24px;
  display:block;
  overflow:hidden;
  border: 6px solid rgba(57,211,83,0.98);
  padding:8px;
  background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.45));
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 14px rgba(57,211,83,0.04) inset;
}
.profile-avatar img{width:100%;height:100%;object-fit:cover;display:block;border-radius:999px}

/* small heading inside profile card */
.profile-title{text-align:center;margin:8px 0 6px;font-weight:700}

/* tags area */
.tags{display:flex;flex-direction:column;gap:8px;margin-top:12px;max-height:330px;overflow:auto;padding-right:6px}
.tag-row{display:flex;flex-wrap:wrap;gap:8px}
.tag{padding:8px 10px;border-radius:8px;border:1.2px solid var(--card-border);background:transparent;color:var(--subtle);cursor:pointer;font-weight:600}
.tag.selected{background:rgba(57,211,83,0.06);color:var(--accent);border-color:rgba(57,211,83,0.3)}

/* small preview grid for folder thumbnails inside profile card */
.preview-mini{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-top:10px}
.preview-mini img{width:100%;height:48px;object-fit:cover;border-radius:4px;border:1px solid rgba(255,255,255,0.04)}

/* tiny helpers */
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* Hover state */
.folder-card:hover{transform:translateY(-6px);box-shadow:0 12px 28px rgba(0,0,0,0.6)}

/* Responsive: stack on small screens */
@media (max-width:1000px){
  .content-area{grid-template-columns:1fr 320px}
  .gallery-grid{grid-template-columns:repeat(3,1fr)}
}
@media (max-width:780px){
  .content-area{grid-template-columns:1fr}
  .profile-card{position:static;transform:none;margin:18px auto;width:92%;max-width:520px}
  header{padding:16px 20px}
  .hero{padding:20px 14px 12px}
  .gallery-grid{grid-template-columns:repeat(2,1fr)}
}
  </style>
</head>
<body>
  <canvas id="bg-canvas" aria-hidden="true"></canvas>

  <header>
    <div style="display:flex;align-items:center;gap:12px">
      <button class="back-btn" id="backBtn" title="Back" aria-label="Back" data-icon="data:svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='20' height='20'%3E%3Cpath d='M15 6l-6 6 6 6' stroke='%2339d353' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E"></button>
      <h1>My Portfolio</h1>
    </div>
    <nav aria-label="top navigation">
      <a href="#">About</a>
      <a href="#">Contact</a>
    </nav>
  </header>

  <div class="hero page-wrap">
    <div class="hero-inner">
      <h2>Explore the <span class="accent">Old Man Edits Gallery</span></h2>
      <p class="sub">Search old man edits by text inside the picture, keywords or tags. Click an image to view it.</p>
    </div>

    <div class="content-area">
      <div>
        <div class="tools">
          <div class="back-btn" id="backToPrev" title="Go back">â—€</div>
          <div class="search"><input id="searchInput" placeholder="Search... (try: sorry, good news, time)" aria-label="Search gallery"></div>
        </div>

        <div class="gallery-wrap">
          <div class="gallery-grid" id="galleryGrid">
            <!-- Example folder items. Each folder-card can be clicked to view that folder. -->
            <!-- data-title, data-tags, data-text, data-folder are used by the JS search/filter -->
			
			<a href="/image/1" class="folder-card" data-id="1"
				data-tags="sorry...,for,your,loss,comic,red,reference,simplified">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/1/image.png">
			</a>
			<a href="/image/2" class="folder-card" data-id="2"
				data-tags="sorry...,you,re,not,a,wizard,hat,magic,magik,hand">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/2/image.png">
			</a>
			<a href="/image/3" class="folder-card" data-id="3"
				data-tags="goood,neeeewwws,yer,an...,hic...,antimeeeme!!,wait...,what,we,talkin','bout,again?,drunk,beer,alcohol,funny">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/3/image.png">
			</a>
			<a href="/image/4" class="folder-card" data-id="4"
				data-tags="sorry...,do,you,have,5,five,cents,pennies,to,spare?,poor,homeless,hungry">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/4/image.png">
			</a>
			<a href="/image/5" class="folder-card" data-id="5"
				data-tags="sorry...,you,re,your,gonna,going,to,have,a,bad,time,blue,flame,undertale,sans,smile,grin,evil">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/5/image.png">
			</a>
			<a href="/image/6" class="folder-card" data-id="6"
				data-tags="ok,idc,who,asked,non,chalant,i,don,t,care">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/6/image.png">
			</a>
			<a href="/image/7" class="folder-card" data-id="7"
				data-tags="good,news,you,re,a,great,bot,heart,love,happy">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/7/image.png">
			</a>
			<a href="/image/8" class="folder-card" data-id="8"
				data-tags="angry,rage,absolutely,not,go,fuck,yourself,shining,eyes">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/8/image.png">
			</a>
			<a href="/image/9" class="folder-card" data-id="9"
				data-tags="new,law,alert,riobox,roblox,confusion,act,lawyer,judge,court,room,hammer,angry,consequences">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/9/image.png">
			</a>
			<a href="/image/10" class="folder-card" data-id="10"
				data-tags="happy,birthday,huge,cake,smile,happy,celebration,special,hat">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/10/image.png">
			</a>
			<a href="/image/11" class="folder-card" data-id="11"
				data-tags="sorry...,i,gave,you,up,rick,astley,rickroll,funny,meme">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/11/image.png">
			</a>
			<a href="/image/12" class="folder-card" data-id="12"
				data-tags="empty,landscape,funny,good,news,i,found,a,group,photo,of,everyone,who,asked,nobody,photo">
				<img 
				loading="lazy" 
				alt="Image thumbnail" 
				src="/image/12/image.png">
			</a>

			<!--
            <div class="folder-card" tabindex="0" role="button" data-folder="Main-Storyline" data-title="Sunset at the Beach" data-tags="beach,sunset,sea" data-text="welcome to summer" data-thumb="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 1 thumbnail" src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <div class="label">Main Storyline</div>
            </div>

<div class="folder-card" tabindex="0" role="button" data-folder="Chapter-1" data-parent="Main-Storyline" data-title="Sunset at the Beach" data-tags="beach,sunset,sea" data-text="welcome to summer" data-thumb="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 1 thumbnail" src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <div class="label">Chapter 1</div>
            </div>

<div class="folder-card" tabindex="0" role="button" data-folder="Chapter-2" data-parent="Main-Storyline" data-title="Sunset at the Beach" data-tags="beach,sunset,sea" data-text="welcome to summer" data-thumb="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 1 thumbnail" src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=60">
              <div class="label">Chapter 2</div>
            </div>

            <div class="folder-card" tabindex="0" role="button" data-folder="Mini-Stories" data-title="Mountain Hike" data-tags="mountain,forest,hike" data-text="trail map here" data-thumb="https://i.ibb.co/LDkr4zC0/Zombo-Droid-13102025110538.jpg?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 2 thumbnail" src="https://i.ibb.co/LDkr4zC0/Zombo-Droid-13102025110538.jpg?auto=format&fit=crop&w=800&q=60">
              <div class="label">Mini Stories</div>
            </div>

            <div class="folder-card" tabindex="0" role="button" data-folder="Old-Man-Edits" data-title="City Nightlife" data-tags="city,night,neon" data-text="open late" data-thumb="https://images.unsplash.com/photo-1499346030926-9a72daac6c63?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 3 thumbnail" src="https://images.unsplash.com/photo-1499346030926-9a72daac6c63?auto=format&fit=crop&w=800&q=60">
              <div class="label">Old Man Edits</div>
            </div>

            <div class="folder-card" tabindex="0" role="button" data-folder="Other" data-title="Portrait Studio" data-tags="portrait,people,studio" data-text="smile" data-thumb="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=800&q=60">
              <img loading="lazy" alt="Folder 4 thumbnail" src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=800&q=60">
              <div class="label">Other</div>
            </div>
			-->
          </div>
        </div>
      </div>

      <aside class="profile-card" id="rightPanel">
        <div class="profile-avatar">
          <img id="previewImg" alt="Hover preview" src="/image/1/image.png">
        </div>
        <div class="profile-title">Folder preview</div>
        <div style="color:var(--subtle);font-size:.95rem;margin-top:6px">Hover an image to preview. Click an image to view it. Use tags below to narrow results (useless for now).</div>

        <div class="tags">
          <div style="font-weight:700;color:var(--subtle);">Selectable tags (useless for now, still developing)</div>
          <div class="tag-row" id="tagRow">
            <!-- tags will be auto-filled from the dataset below -->
          </div>
		<!--
          <div style="font-weight:700;color:var(--subtle);margin-top:8px">Recent thumbnails</div>
          <div class="preview-mini" id="miniPreviews">
            (small previews will appear here on hover)
		-->
          </div>
        </div>
      </aside>

    </div>
  </div>

  <script>
  // ----------------- Canvas Background -----------------
  (function(){
    const canvas = document.getElementById('bg-canvas');
    const ctx = canvas.getContext('2d');
    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;

    let mouse = { x: -1000, y: -1000 };
    let bgOffsetX = 0, bgOffsetY = 0;
    const r = 50;
    const colSpacing = Math.sqrt(3) * r;
    const rowSpacing = 1.5 * r;
    const strokeColor = 'rgba(57,211,83,0.12)';
    const lineWidth = 1.6;
    let ripples = [];

    function drawHex(x, y, r) {
      ctx.beginPath();
      for (let i = 0; i < 6; i++) {
        const angle = Math.PI / 6 + i * Math.PI / 3;
        const px = x + r * Math.cos(angle);
        const py = y + r * Math.sin(angle);
        if (i === 0) ctx.moveTo(px, py); else ctx.lineTo(px, py);
      }
      ctx.closePath();
      ctx.strokeStyle = strokeColor;
      ctx.lineWidth = lineWidth;
      ctx.stroke();
    }

    function drawBackground() {
      ctx.clearRect(0, 0, width, height);
      const startCol = Math.floor(-bgOffsetX / colSpacing) - 3;
      const endCol   = Math.ceil((width - bgOffsetX) / colSpacing) + 3;
      const startRow = Math.floor(-bgOffsetY / rowSpacing) - 3;
      const endRow   = Math.ceil((height - bgOffsetY) / rowSpacing) + 3;

      for (let row = startRow; row < endRow; row++) {
        for (let col = startCol; col < endCol; col++) {
          const offsetX = (row % 2) * (colSpacing / 2);
          const baseX = col * colSpacing + offsetX + bgOffsetX;
          const baseY = row * rowSpacing + bgOffsetY;
          let dx = baseX - mouse.x, dy = baseY - mouse.y;
          let dist = Math.sqrt(dx*dx + dy*dy);
          let adjX = baseX, adjY = baseY;

          if (dist < 150) {
            const force = (1 - dist/150) * 4;
            adjX += Math.sin(dy/20) * force;
            adjY += Math.cos(dx/20) * force;
          }

          ripples.forEach(rp => {
            const dxr = baseX - rp.x;
            const dyr = baseY - rp.y;
            const distR = Math.sqrt(dxr*dxr + dyr*dyr);
            if (distR < 200) {
              const force = (1 - distR/200) * rp.strength;
              adjX += Math.sin(dyr/20) * force;
              adjY += Math.cos(dxr/20) * force;
            }
          });

          drawHex(adjX, adjY, r);
        }
      }
    }

    function animate() {
      bgOffsetX += 0.12;
      bgOffsetY += 0.06;
      drawBackground();
      ripples = ripples.filter(r => (r.strength -= 0.6) > 0);
      requestAnimationFrame(animate);
    }
    animate();

    document.addEventListener('mousemove', e => (mouse = { x: e.clientX, y: e.clientY }));
    document.addEventListener('mouseleave', () => (mouse = { x: -1000, y: -1000 }));
    document.addEventListener('click', e => ripples.push({ x: e.clientX, y: e.clientY, strength: 18 }));
    window.addEventListener('resize', () => {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    });
  })();

  // ----------------- Gallery behavior with nested folders -----------------
  (function(){
    const galleryGrid = document.getElementById('galleryGrid');
    const searchInput = document.getElementById('searchInput');
    const previewImg = document.getElementById('previewImg');
    const tagRow = document.getElementById('tagRow');
    const miniPreviews = document.getElementById('miniPreviews');
    const folders = Array.from(document.querySelectorAll('.folder-card'));
    let activeFolder = null;

    // Show only top-level folders initially
    function showTopLevel() {
      folders.forEach(f => {
        f.style.display = !f.dataset.parent ? '' : 'none';
      });
    }

    showTopLevel();

    // Build tag set
    const tagSet = new Set();
    folders.forEach(f => {
      const t = (f.dataset.tags||'').split(',').map(s=>s.trim()).filter(Boolean);
      t.forEach(x=>tagSet.add(x));
    });

    // Populate tags
    tagSet.forEach(t => {
      const btn = document.createElement('button');
      btn.className = 'tag';
      btn.type = 'button';
      btn.textContent = t;
      btn.dataset.tag = t;
      btn.addEventListener('click', () => {
        btn.classList.toggle('selected');
        applyFilters();
      });
      tagRow.appendChild(btn);
    });

    function applyFilters() {
  const q = searchInput.value.trim().toLowerCase();
  const selectedTags = Array.from(document.querySelectorAll('.tag.selected')).map(b => b.dataset.tag.toLowerCase());
  const tokens = q.length ? q.split(/\s+/).map(s => s.trim()).filter(Boolean) : [];

  folders.forEach(card => {
    const title = (card.dataset.title || '').toLowerCase();
    const tags = (card.dataset.tags || '').toLowerCase().split(',').map(t => t.trim());
    const text = (card.dataset.text || '').toLowerCase();
    const folder = (card.dataset.folder || '').toLowerCase();
    const combined = `${title} ${tags.join(' ')} ${text} ${folder}`;

    const tokensOK = tokens.every(tok => combined.includes(tok));
    const tagsOK = selectedTags.every(t => tags.includes(t));

    // Determine if this folder should be visible based on hierarchy
    const parent = card.dataset.parent || null;
    const inActive = !activeFolder 
      ? !parent // only top-level
      : (card.dataset.folder === activeFolder || parent === activeFolder);

    // Only show items that both match filters and are in the current view
    card.style.display = (tokensOK && tagsOK && inActive) ? '' : 'none';
  });

  updateMiniPreviews();
}

    searchInput.addEventListener('input', applyFilters);

    function updateMiniPreviews() {
      const visible = folders.filter(f=>f.style.display !== 'none');
      miniPreviews.innerHTML = '';
      visible.slice(0,8).forEach(f => {
        const im = document.createElement('img');
        im.src = f.dataset.thumb || f.querySelector('img')?.src;
        im.alt = 'recent';
        miniPreviews.appendChild(im);
      });
    }

    // Initialize view from URL hash
    function updateFromHash() {
      const hash = decodeURIComponent(location.hash.replace('#',''));
      if(!hash) {
        activeFolder = null;
        showTopLevel();
      } else {
        activeFolder = hash;
        folders.forEach(f => {
          const parent = f.dataset.parent || null;
          f.style.display = (f.dataset.folder === hash || parent === hash) ? '' : 'none';
        });
      }
      updateMiniPreviews();
    }

    updateFromHash();

    window.addEventListener('popstate', updateFromHash);
    window.addEventListener('hashchange', updateFromHash);

    // Folder click handler
    folders.forEach(card => {
      card.addEventListener('click', () => {
        const folderName = card.dataset.folder;

        if(activeFolder === folderName) {
          activeFolder = card.dataset.parent || null;
        } else {
          activeFolder = folderName;
        }

        folders.forEach(f => {
          const parent = f.dataset.parent || null;
          if(!activeFolder) {
            f.style.display = !f.dataset.parent ? '' : 'none';
          } else {
            f.style.display = (f.dataset.folder === activeFolder || parent === activeFolder) ? '' : 'none';
          }
        });

        // Update URL hash
        if(activeFolder) {
          history.pushState({folder: activeFolder}, '', `#${encodeURIComponent(activeFolder)}`);
        } else {
          history.pushState({folder:null}, '', location.pathname);
        }

        updateMiniPreviews();
      });

      // Hover preview
      card.addEventListener('mouseenter', () => {
        const src = card.dataset.thumb || card.querySelector('img')?.src;
        if(src) previewImg.src = src;
        miniPreviews.innerHTML = '';
        for(let i=0;i<6;i++){
          const im = document.createElement('img');
          im.src = src;
          im.alt = card.dataset.folder + ' preview ' + i;
          miniPreviews.appendChild(im);
        }
      });

      // Keyboard accessibility
      card.addEventListener('keydown', e => { if(e.key==='Enter') card.click(); });
    });

    document.getElementById('backToPrev')?.addEventListener('click', ()=>history.back());

    // Inject icons
    document.querySelectorAll('[data-icon]').forEach(el => {
      const url = el.dataset.icon;
      if(url && url.startsWith('data:')){
        try{ el.innerHTML = decodeURIComponent(url.split(',')[1]); }catch(e){}
        return;
      }
      fetch(url).then(res=>res.text()).then(svg=>{ el.innerHTML = svg }).catch(()=>{});
    });

  })();
</script>
</body>
</html>